(()=>{"use strict";var r,x={265:(r,a,o)=>{var p=o(670),d=o(595),c=o(938),m=o(228);const k="__type__";var l=(()=>{return(s=l||(l={})).STATUS="status",s.RESULT="result",s.RUN="run",l;var s})();function E(s,e){postMessage({data:s,[k]:e})}function T(s,e){return k in s&&s[k]===e}const O="root",w="progress_status";function _(s){return function q(s,e){self.dispatchEvent(new CustomEvent(w,{detail:{id:s,data:e}}))}(O,s)}class D{constructor(e){this.callback=e,this.previousData=void 0}maybeCallWith(e){(0,c.isEqual)(e,this.previousData)||(this.previousData=e,this.callback(e))}}class v{constructor(e,t,i=!1){this.processorGenerator=e,this.isDebugging=i,this.idleProcessors=[],this.pendingWorkQueue=[],this.runningWorkQueue=[],this.isStartWorkQueued=!1,(0,c.range)(t).forEach(()=>this.idleProcessors.push(e()))}hasWork(){return this.pendingWorkQueue.length>0}hasIdleProcessors(){return this.idleProcessors.length>0}queueStartWork(){this.isStartWorkQueued||(setTimeout(()=>this.startWork(),0),this.isStartWorkQueued=!0)}startWork(){this.debug("startWork",this.pendingWorkQueue.length,this.idleProcessors.length),this.isStartWorkQueued=!1,(0,c.range)(Math.min(this.pendingWorkQueue.length,this.idleProcessors.length)).forEach(()=>{if(!this.hasWork()||!this.hasIdleProcessors())return;const e=this.dequeueFirst(),t=this.idleProcessors.pop();this.onWorkStarted(e,t),this.debug("Starting work",e.id,e.work.functionName),t.execute(e.work,e.onStatus).then(i=>(this.debug("Work result",e.id,e.work.functionName),e.onData(i))).catch(i=>{this.debug("Work error:",i,e.work.functionName),e.onError(i)}).finally(()=>{this.debug("Work finished",e.id,e.work.functionName),this.stop(e.id),this.queueStartWork()})})}debug(...e){this.isDebugging&&console.debug(...e)}onWorkStarted(e,t){this.debug("onWorkStarted",e.id,e.work.functionName),this.runningWorkQueue.push({queuedWork:e,processor:t})}stop(e,t=(()=>{})){this.debug("stop",e),this.dequeue(e);const i=this.dequeueWorkInProgress(e);i&&(this.debug("Stopping processor"),i.processor.stop(),t(i),this.debug("Recycling processor"),this.idleProcessors.push(i.processor))}enqueue(e){const t=new m.x,i=new D(g=>t.next(g)),u=`${this.pendingWorkQueue.length}_${(new Date).getTime()}_${Math.floor(1e4*Math.random())}`,f=()=>{this.debug("workHandler stop",u),this.stop(u)};this.debug("enqueue",u,e.functionName);const h=new Promise((g,W)=>{this.pendingWorkQueue.push({id:u,work:e,stop:f,onData:g,onError:W,onStatus:S=>i.maybeCallWith(S)}),this.debug("pendingWork push",u,e.functionName,this.pendingWorkQueue.length)});return this.queueStartWork(),{id:u,data:h,status:t,stop:f}}dequeueFirst(){this.debug("dequeueFirst");const e=this.pendingWorkQueue.slice(0,1).pop();if(e)return this.dequeue(e.id)}dequeue(e){this.debug("dequeue",e);const t=this.pendingWorkQueue.findIndex(i=>i.id===e);if(t>-1)return this.pendingWorkQueue.splice(t,1).pop()}dequeueWorkInProgress(e){this.debug("dequeueWorkInProgress",e);const t=this.runningWorkQueue.findIndex(i=>i.queuedWork.id===e);if(t>-1)return this.runningWorkQueue.splice(t,1).pop()}stopAll(){this.pendingWorkQueue.forEach(e=>e.stop()),this.runningWorkQueue.forEach(e=>e.queuedWork.stop())}}var s;(s=v||(v={})).WebWorkerProcessor=class e{constructor(u){this.workerGenerator=u}getWorker(){return this.worker||(this.worker=this.workerGenerator()),this.worker}execute(u,f){const h=this.getWorker(),g=new Promise((W,S)=>{h.onmessage=({data:y})=>{!function I(s){return T(s,l.RESULT)}(y)?function G(s){return T(s,l.STATUS)}(y)&&f(y.data.data):W(y.data)},h.onerror=S,h.onmessageerror=S}).finally(()=>{h.onmessage=()=>{},h.onerror=()=>{},h.onmessageerror=()=>{}});return h.postMessage(function C(s,e){return{[k]:l.RUN,functionName:s,args:e}}(u.functionName,u.args)),g}stop(){var u;null===(u=this.worker)||void 0===u||u.terminate(),this.worker=void 0}},s.LocalProcessor=class t{execute(u,f){return(0,p.Z)(function*(){const h=W=>{f(W.detail.data)};self.addEventListener(w,h);const g=yield u.function(...u.args);return self.removeEventListener(w,h),g})()}stop(){}};const B=()=>new Worker(o.tu(new URL(o.p+o.u(265),o.b))),J=()=>new Worker(o.tu(new URL(o.p+o.u(232),o.b))),V=()=>new v.LocalProcessor,Y=()=>new v.WebWorkerProcessor(B),z=()=>new v.WebWorkerProcessor(J);class P{constructor(e,t=!1){this.solverConfig=e,this.shouldDebug=t,this.currentStatus={current:0,buffer:0,total:100},this.status=new m.x,this.pooledExecutor=new v(function F(s,e){return s.useWorker?e?z:Y:V}(e,!0),e.useWorker?e.workerCount:1),this.pooledCommonWorkerFunctions=function Z(s,e){return new Proxy(e,{get:(t,i)=>(...u)=>s.enqueue({args:u,functionName:i.toString(),function:e[i]})})}(this.pooledExecutor,d.js),this.arraySplitGroupSize=2*this.solverConfig.workerCount}debug(...e){this.shouldDebug&&console.debug(...e)}incrementBuffer(e){this.currentStatus.buffer+=e,this.status.next(Object.assign({},this.currentStatus))}incrementProgress(e){this.currentStatus.current+=e,this.status.next(Object.assign({},this.currentStatus))}monitorProgressIncrementor(e,t){return Array.isArray(e)?e[0]instanceof Promise?e.map(i=>this.monitorProgressIncrementor(i,t)):(this.incrementProgress(t*e.length),e):e instanceof Promise?e.finally(()=>this.incrementProgress(t)):(this.incrementProgress(t),e)}monitorProgress(e,t){return this.incrementBuffer(100*t),Array.isArray(e)?this.monitorProgressIncrementor(e,1/e.length*t*100):this.monitorProgressIncrementor(e,100*t)}calculate(e){var t=this;return(0,p.Z)(function*(){if(t.currentStatus.current=0,e.faces.length<2||0===e.operations.length||e.maxTotal<e.minTotal)return[];t.incrementProgress(0);const i=(new Date).getTime();let u=(new Date).getTime();const[f,h]=t.monitorProgress(d.js.getFaceAndOperationPermutations(e),.05);t.debug("permutations",(new Date).getTime()-u,"ms",f.length),u=(new Date).getTime();const g=yield Promise.all(t.monitorProgress((0,c.chunk)(f,100).map(S=>t.pooledCommonWorkerFunctions.calculateFromFaceAndOperationPermutations(e,S,h).data),.8));t.debug("initial results",(new Date).getTime()-u,"ms",g.length),u=(new Date).getTime();const W=t.monitorProgress(d.js.mergeCalculateResultsArrays(g),.15);return t.debug("merged results",(new Date).getTime()-u,"ms",W.length),t.debug("full run",(new Date).getTime()-i,"ms"),t.incrementProgress(t.currentStatus.total-t.currentStatus.current),W})()}stop(){this.pooledExecutor.stopAll()}static stop(){var e,t;null===(e=P.solver)||void 0===e||e.stop(),null===(t=P.solver)||void 0===t||t.status.unsubscribe()}static calculate(e,t){return(0,p.Z)(function*(){if(P.solver)throw new Error("Processor is already running. Stop it before trying again.");const i=new P(e);i.status.subscribe(_),P.solver=new P(e);const u=yield i.calculate(t);return P.solver=void 0,u})()}}!function $(s){const e=new D(t=>function U(s){E(s,l.STATUS)}(t.detail));self.addEventListener(w,t=>{t.detail.id===O&&e.maybeCallWith(t)}),self.addEventListener("message",function(){var t=(0,p.Z)(function*(i){const{data:u}=i;if(!function M(s,e){return T(s,l.RUN)&&"functionName"in s&&"args"in s&&"string"==typeof s.functionName&&Array.isArray(s.args)&&s.functionName in e&&"function"==typeof e[s.functionName]}(u,s)){const f=Object.fromEntries(Object.entries(s).map(([h,g])=>[h,typeof g]));throw new Error(`Invalid ${l.RUN} message ${JSON.stringify(u,null,2)}. Expose object structure: ${JSON.stringify(f,null,2)}`)}!function L(s){E(s,l.RESULT)}(yield s[u.functionName](...u.args))});return function(i){return t.apply(this,arguments)}}())}({calculate:P.calculate})}},R={};function n(r){var a=R[r];if(void 0!==a)return a.exports;var o=R[r]={id:r,loaded:!1,exports:{}};return x[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=x,n.x=()=>{var r=n.O(void 0,[47],()=>n(265));return n.O(r)},r=[],n.O=(a,o,p,d)=>{if(!o){var m=1/0;for(c=0;c<r.length;c++){for(var[o,p,d]=r[c],k=!0,l=0;l<o.length;l++)(!1&d||m>=d)&&Object.keys(n.O).every(N=>n.O[N](o[l]))?o.splice(l--,1):(k=!1,d<m&&(m=d));if(k){r.splice(c--,1);var b=p();void 0!==b&&(a=b)}}return a}d=d||0;for(var c=r.length;c>0&&r[c-1][2]>d;c--)r[c]=r[c-1];r[c]=[o,p,d]},n.n=r=>{var a=r&&r.__esModule?()=>r.default:()=>r;return n.d(a,{a}),a},n.d=(r,a)=>{for(var o in a)n.o(a,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:a[o]})},n.f={},n.e=r=>Promise.all(Object.keys(n.f).reduce((a,o)=>(n.f[o](r,a),a),[])),n.u=r=>r+"."+{47:"a77b4e54f0d57a94",232:"0c000d62613e8b0f",265:"7d57d658350d0767"}[r]+".js",n.miniCssF=r=>{},n.o=(r,a)=>Object.prototype.hasOwnProperty.call(r,a),n.nmd=r=>(r.paths=[],r.children||(r.children=[]),r),(()=>{var r;n.tt=()=>(void 0===r&&(r={createScriptURL:a=>a},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(r=trustedTypes.createPolicy("angular#bundler",r))),r)})(),n.tu=r=>n.tt().createScriptURL(r),n.p="",(()=>{n.b=self.location+"";var r={265:1};n.f.i=(d,c)=>{r[d]||importScripts(n.tu(n.p+n.u(d)))};var o=self.webpackChunkapp=self.webpackChunkapp||[],p=o.push.bind(o);o.push=d=>{var[c,m,k]=d;for(var l in m)n.o(m,l)&&(n.m[l]=m[l]);for(k&&k(n);c.length;)r[c.pop()]=1;p(d)}})(),(()=>{var r=n.x;n.x=()=>n.e(47).then(r)})(),n.x()})();
//# sourceMappingURL=265.7d57d658350d0767.js.map